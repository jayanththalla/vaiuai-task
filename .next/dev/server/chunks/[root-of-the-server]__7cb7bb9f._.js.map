{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jayan/Desktop/tasks/vaiuai/app/api/weather/route.ts"],"sourcesContent":["/**\n * Weather API Route Handler\n *\n * This endpoint fetches weather data from OpenWeatherMap API\n * and returns formatted weather information.\n *\n * Environment Variables Required:\n * - OPENWEATHERMAP_API_KEY: Your OpenWeatherMap API key\n *\n * To get an API key:\n * 1. Go to https://openweathermap.org/api\n * 2. Sign up for a free account\n * 3. Get your API key from the dashboard\n */\n\nimport { type NextRequest, NextResponse } from \"next/server\"\n\n// OpenWeatherMap API base URL\nconst WEATHER_API_BASE = \"https://api.openweathermap.org/data/2.5\"\n\nexport async function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams\n  const city = searchParams.get(\"city\")\n\n  // Validate city parameter\n  if (!city) {\n    return NextResponse.json({ error: \"City parameter is required\" }, { status: 400 })\n  }\n\n  // Get API key from environment variables\n  const apiKey = process.env.OPENWEATHERMAP_API_KEY\n\n  // If no API key is configured, return mock data for demo purposes\n  if (!apiKey) {\n    console.log(\"[v0] No API key found, using mock data for demo\")\n    return NextResponse.json(getMockWeatherData(city))\n  }\n\n  try {\n    // Fetch current weather\n    const currentWeatherUrl = `${WEATHER_API_BASE}/weather?q=${encodeURIComponent(city)}&appid=${apiKey}&units=metric`\n    const currentResponse = await fetch(currentWeatherUrl)\n\n    if (!currentResponse.ok) {\n      if (currentResponse.status === 404) {\n        return NextResponse.json(\n          { error: `City \"${city}\" not found. Please check the spelling and try again.` },\n          { status: 404 },\n        )\n      }\n      if (currentResponse.status === 401) {\n        return NextResponse.json(\n          { error: \"Invalid API key. Please check your OpenWeatherMap API key.\" },\n          { status: 401 },\n        )\n      }\n      throw new Error(`Weather API error: ${currentResponse.status}`)\n    }\n\n    const currentData = await currentResponse.json()\n\n    // Fetch 5-day forecast for tomorrow's data\n    const forecastUrl = `${WEATHER_API_BASE}/forecast?q=${encodeURIComponent(city)}&appid=${apiKey}&units=metric`\n    const forecastResponse = await fetch(forecastUrl)\n    let forecastData = null\n\n    if (forecastResponse.ok) {\n      const forecast = await forecastResponse.json()\n      // Get tomorrow's forecast (around 24 hours from now)\n      const tomorrow = forecast.list.find((item: { dt: number }) => {\n        const itemDate = new Date(item.dt * 1000)\n        const now = new Date()\n        const hoursDiff = (itemDate.getTime() - now.getTime()) / (1000 * 60 * 60)\n        return hoursDiff >= 20 && hoursDiff <= 28\n      })\n\n      if (tomorrow) {\n        forecastData = {\n          temp: Math.round(tomorrow.main.temp),\n          description: tomorrow.weather[0].description,\n          rainChance: Math.round((tomorrow.pop || 0) * 100),\n        }\n      }\n    }\n\n    // Format and return weather data\n    const weatherData = {\n      city: currentData.name,\n      temp: Math.round(currentData.main.temp),\n      feelsLike: Math.round(currentData.main.feels_like),\n      description: currentData.weather[0].description,\n      humidity: currentData.main.humidity,\n      windSpeed: Math.round(currentData.wind.speed * 3.6), // Convert m/s to km/h\n      visibility: currentData.visibility ? Math.round(currentData.visibility / 1000) : undefined,\n      pressure: currentData.main.pressure,\n      icon: currentData.weather[0].icon,\n      forecast: forecastData,\n    }\n\n    return NextResponse.json(weatherData)\n  } catch (error) {\n    console.error(\"[v0] Weather API error:\", error)\n    return NextResponse.json({ error: \"Failed to fetch weather data. Please try again later.\" }, { status: 500 })\n  }\n}\n\n/**\n * Generate mock weather data for demonstration\n * This is used when no API key is configured\n */\nfunction getMockWeatherData(city: string) {\n  // Generate somewhat realistic mock data based on city name\n  const hash = city.split(\"\").reduce((acc, char) => acc + char.charCodeAt(0), 0)\n\n  const conditions = [\n    { description: \"sunny\", temp: 28 + (hash % 10) },\n    { description: \"partly cloudy\", temp: 24 + (hash % 8) },\n    { description: \"cloudy\", temp: 22 + (hash % 6) },\n    { description: \"light rain\", temp: 20 + (hash % 5) },\n    { description: \"clear sky\", temp: 26 + (hash % 9) },\n  ]\n\n  const condition = conditions[hash % conditions.length]\n\n  return {\n    city: city.charAt(0).toUpperCase() + city.slice(1).toLowerCase(),\n    temp: condition.temp,\n    feelsLike: condition.temp + (hash % 3) - 1,\n    description: condition.description,\n    humidity: 45 + (hash % 40),\n    windSpeed: 5 + (hash % 20),\n    visibility: 8 + (hash % 7),\n    pressure: 1010 + (hash % 20),\n    forecast: {\n      temp: condition.temp + (hash % 4) - 2,\n      description: conditions[(hash + 1) % conditions.length].description,\n      rainChance: hash % 80,\n    },\n  }\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;CAaC;;;;AAED;;AAEA,8BAA8B;AAC9B,MAAM,mBAAmB;AAElB,eAAe,IAAI,OAAoB;IAC5C,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,0BAA0B;IAC1B,IAAI,CAAC,MAAM;QACT,OAAO,+UAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;IAEA,yCAAyC;IACzC,MAAM,SAAS,QAAQ,GAAG,CAAC,sBAAsB;IAEjD,kEAAkE;IAClE,IAAI,CAAC,QAAQ;QACX,QAAQ,GAAG,CAAC;QACZ,OAAO,+UAAY,CAAC,IAAI,CAAC,mBAAmB;IAC9C;IAEA,IAAI;QACF,wBAAwB;QACxB,MAAM,oBAAoB,GAAG,iBAAiB,WAAW,EAAE,mBAAmB,MAAM,OAAO,EAAE,OAAO,aAAa,CAAC;QAClH,MAAM,kBAAkB,MAAM,MAAM;QAEpC,IAAI,CAAC,gBAAgB,EAAE,EAAE;YACvB,IAAI,gBAAgB,MAAM,KAAK,KAAK;gBAClC,OAAO,+UAAY,CAAC,IAAI,CACtB;oBAAE,OAAO,CAAC,MAAM,EAAE,KAAK,qDAAqD,CAAC;gBAAC,GAC9E;oBAAE,QAAQ;gBAAI;YAElB;YACA,IAAI,gBAAgB,MAAM,KAAK,KAAK;gBAClC,OAAO,+UAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAA6D,GACtE;oBAAE,QAAQ;gBAAI;YAElB;YACA,MAAM,IAAI,MAAM,CAAC,mBAAmB,EAAE,gBAAgB,MAAM,EAAE;QAChE;QAEA,MAAM,cAAc,MAAM,gBAAgB,IAAI;QAE9C,2CAA2C;QAC3C,MAAM,cAAc,GAAG,iBAAiB,YAAY,EAAE,mBAAmB,MAAM,OAAO,EAAE,OAAO,aAAa,CAAC;QAC7G,MAAM,mBAAmB,MAAM,MAAM;QACrC,IAAI,eAAe;QAEnB,IAAI,iBAAiB,EAAE,EAAE;YACvB,MAAM,WAAW,MAAM,iBAAiB,IAAI;YAC5C,qDAAqD;YACrD,MAAM,WAAW,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnC,MAAM,WAAW,IAAI,KAAK,KAAK,EAAE,GAAG;gBACpC,MAAM,MAAM,IAAI;gBAChB,MAAM,YAAY,CAAC,SAAS,OAAO,KAAK,IAAI,OAAO,EAAE,IAAI,CAAC,OAAO,KAAK,EAAE;gBACxE,OAAO,aAAa,MAAM,aAAa;YACzC;YAEA,IAAI,UAAU;gBACZ,eAAe;oBACb,MAAM,KAAK,KAAK,CAAC,SAAS,IAAI,CAAC,IAAI;oBACnC,aAAa,SAAS,OAAO,CAAC,EAAE,CAAC,WAAW;oBAC5C,YAAY,KAAK,KAAK,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI;gBAC/C;YACF;QACF;QAEA,iCAAiC;QACjC,MAAM,cAAc;YAClB,MAAM,YAAY,IAAI;YACtB,MAAM,KAAK,KAAK,CAAC,YAAY,IAAI,CAAC,IAAI;YACtC,WAAW,KAAK,KAAK,CAAC,YAAY,IAAI,CAAC,UAAU;YACjD,aAAa,YAAY,OAAO,CAAC,EAAE,CAAC,WAAW;YAC/C,UAAU,YAAY,IAAI,CAAC,QAAQ;YACnC,WAAW,KAAK,KAAK,CAAC,YAAY,IAAI,CAAC,KAAK,GAAG;YAC/C,YAAY,YAAY,UAAU,GAAG,KAAK,KAAK,CAAC,YAAY,UAAU,GAAG,QAAQ;YACjF,UAAU,YAAY,IAAI,CAAC,QAAQ;YACnC,MAAM,YAAY,OAAO,CAAC,EAAE,CAAC,IAAI;YACjC,UAAU;QACZ;QAEA,OAAO,+UAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,+UAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwD,GAAG;YAAE,QAAQ;QAAI;IAC7G;AACF;AAEA;;;CAGC,GACD,SAAS,mBAAmB,IAAY;IACtC,2DAA2D;IAC3D,MAAM,OAAO,KAAK,KAAK,CAAC,IAAI,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,UAAU,CAAC,IAAI;IAE5E,MAAM,aAAa;QACjB;YAAE,aAAa;YAAS,MAAM,KAAM,OAAO;QAAI;QAC/C;YAAE,aAAa;YAAiB,MAAM,KAAM,OAAO;QAAG;QACtD;YAAE,aAAa;YAAU,MAAM,KAAM,OAAO;QAAG;QAC/C;YAAE,aAAa;YAAc,MAAM,KAAM,OAAO;QAAG;QACnD;YAAE,aAAa;YAAa,MAAM,KAAM,OAAO;QAAG;KACnD;IAED,MAAM,YAAY,UAAU,CAAC,OAAO,WAAW,MAAM,CAAC;IAEtD,OAAO;QACL,MAAM,KAAK,MAAM,CAAC,GAAG,WAAW,KAAK,KAAK,KAAK,CAAC,GAAG,WAAW;QAC9D,MAAM,UAAU,IAAI;QACpB,WAAW,UAAU,IAAI,GAAI,OAAO,IAAK;QACzC,aAAa,UAAU,WAAW;QAClC,UAAU,KAAM,OAAO;QACvB,WAAW,IAAK,OAAO;QACvB,YAAY,IAAK,OAAO;QACxB,UAAU,OAAQ,OAAO;QACzB,UAAU;YACR,MAAM,UAAU,IAAI,GAAI,OAAO,IAAK;YACpC,aAAa,UAAU,CAAC,CAAC,OAAO,CAAC,IAAI,WAAW,MAAM,CAAC,CAAC,WAAW;YACnE,YAAY,OAAO;QACrB;IACF;AACF"}}]
}